<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orbital Airlines - Explore the World with Comfort</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Navigation Bar -->
    <nav>
        <img src="img/orbital_airline_logo.png" style="width: 160px; height: 60px; border-radius: 10px;"
            alt="Right Logo">
        <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#destinations">Destinations</a></li>
            <li><a href="#about">About Us</a></li>
            <li><a href="#contact">Contact</a></li>
            <li id="login-logout-item">
                <!-- Login or Logout will be dynamically inserted here -->
            </li>
        </ul>
        <div class="right-logo">
            <img src="img/Image.jpg" alt="Right Logo">
        </div>
    </nav>

    <!-- Header -->
    <header id="home">
        <div class="overlay"></div>
        <div class="header-content">
            <h1>Fly Beyond Limits</h1>
            <p>Book your next adventure with Orbital Airlines.</p>
            <button class="cta-button">Book Now</button>
        </div>
    </header>

    <!-- Popular Destinations Section -->
    <section id="destinations">
        <h2>Discover Our Popular Destinations</h2>
        <p>From the serene beaches of the Maldives to the bustling cityscapes of Tokyo, Orbital Airlines takes you where
            you want to be with comfort and ease.</p>

        <div class="cards">
            <div class="card">
                <img src="https://images.unsplash.com/photo-1502602898657-3e91760cbb34?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwzNjUyOXwwfDF8c2VhcmNofDJ8fHBhcmlzfGVufDB8fHx8MTY5NTA4MjY3NQ&ixlib=rb-1.2.1&q=80&w=1080"
                    alt="Paris">
                <h3 class="card-title">Paris, France</h3>
                <p class="card-description">The city of love awaits you with iconic sights and charming cafes.</p>
            </div>
            <div class="card">
                <img src="https://media.istockphoto.com/id/1131743616/photo/aerial-view-of-tokyo-cityscape-with-fuji-mountain-in-japan.webp?a=1&b=1&s=612x612&w=0&k=20&c=M4BnBxDnlp1EQGHutJR9AAUI_7O9nwCvXKpuUmqrUdQ="
                    alt="Tokyo">
                <h3 class="card-title">Tokyo, Japan</h3>
                <p class="card-description">Experience the future in Tokyo's neon-lit streets and rich cultural history.
                </p>
            </div>
            <div class="card">
                <img src="https://media.istockphoto.com/id/1348963437/photo/foot-path-to-jetty.webp?a=1&b=1&s=612x612&w=0&k=20&c=BIFdGYKgBUhCi6MPrwjsfLjn2-RpZMLzAe4V7zEV0p4="
                    alt="Maldives">
                <h3 class="card-title">Maldives</h3>
                <p class="card-description">Relax in the pristine waters of the Maldives, your paradise getaway.</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact">
        <p>Ready to take off with Orbital Airlines? Let's get you where you want to go.</p>
        <p>For inquiries, email us at <a href="mailto:info@orbitalairlines.com">info@orbitalairlines.com</a> or call us
            at 1-800-FLY-HIGH.</p>
    </footer>

    <!-- Login/Sign Up Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>Login</h2>
            <input type="email" id="email" placeholder="Enter your email" required>
            <input type="password" id="password" placeholder="Enter your password" required>
            <button onclick="loginUser()">Login</button>
        </div>
    </div>

    <!-- Integrate Chatbot -->
    <script src='https://cdn.jsdelivr.net/npm/kore-web-sdk@11.6.0/dist/umd/kore-web-sdk-umd-chat.min.js'></script>
    <script>
        // Function to initialize the chat window
        function initializeChat() {
            // Get the user's email from localStorage
            const userEmail = localStorage.getItem('userEmail') || 'default-email@example.com';
            console.log("UserEmail: ", userEmail);

            // Update the chat configuration to pass the user's email as custom context data
            KoreChatSDK.chatConfig.botOptions.API_KEY_CONFIG.KEY = 'db9af42e6edc4367bc449d115079c5fed68e6e1f5a9d434190bf1a61c5ca6f9ast14';

            // Pass user's email as customData to be accessible in the bot's context
            KoreChatSDK.chatConfig.botOptions.botInfo.customData = {
                webContext: {
                    email: userEmail
                }
            };

            // Optional: Set userIdentity to make sure the bot uniquely identifies the user
            KoreChatSDK.chatConfig.botOptions.botInfo.userIdentity = userEmail;

            // Initialize or show the chat window with the updated configuration
            new KoreChatSDK.chatWindow().show(KoreChatSDK.chatConfig);

            console.log("KoreChatSDK.chatConfig: ", KoreChatSDK.chatConfig);
        }

        // Open Modal
        function openModal() {
            document.getElementById('loginModal').style.display = 'flex';
        }

        // Close Modal
        function closeModal() {
            document.getElementById('loginModal').style.display = 'none';
        }

        // Login User
        function loginUser() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            if (email && password) {
                localStorage.setItem('isLoggedIn', true);
                localStorage.setItem('userEmail', email);
                closeModal();
                updateLoginLogout(); // Update the login/logout icon right after login

                // Reinitialize the chat with the new user email
                initializeChat(); // Update chat configuration after login

                window.location.href = '#home';
            } else {
                alert('Please enter both email and password.');
            }
        }

        // Logout User
        function logoutUser() {
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('userEmail');
            alert('You have successfully logged out.');
            updateLoginLogout(); // Update the login/logout icon right after logout

            // Do not reinitialize chat on logout
            window.location.href = '#home';
        }

        // Update Navbar to Show Login or Logout
        function updateLoginLogout() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const loginLogoutItem = document.getElementById('login-logout-item');

            if (isLoggedIn === 'true') {
                loginLogoutItem.innerHTML = `
                    <a href="#" onclick="logoutUser()">
                        <img src="img/logout.png" class="login-logout-icon" alt="Logout">
                    </a>`;
            } else {
                loginLogoutItem.innerHTML = `
                    <a href="#" onclick="openModal()">
                        <img src="img/user.png" class="login-logout-icon" alt="Login">
                    </a>`;
            }
        }

        // Initialize chat and update login/logout UI on page load
        document.addEventListener('DOMContentLoaded', function () {
            updateLoginLogout(); // Update login/logout UI
            if (localStorage.getItem('isLoggedIn') === 'true') {
                initializeChat(); // Initialize chat only if logged in
            }
        });
    </script>

</body>

</html>